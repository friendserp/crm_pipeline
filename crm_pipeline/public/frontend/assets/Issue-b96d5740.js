import{_ as c,m as r,M as t,N as n,q as m,p,a4 as b,G as a,a3 as x,a1 as g,a2 as f,l as u}from"./index-f283a836.js";const y={name:"IssueDetail",props:{issue:{type:Object,required:!0}},data(){return{showEditModal:!1,editableIssue:{}}},watch:{issue:{immediate:!0,handler(s){this.editableIssue={...s}}}},methods:{editIssue(){this.showEditModal=!0},async saveIssue(){try{const s=await fetch("/api/method/frappe.client.set_value",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":this.getCSRFToken()},body:JSON.stringify({doctype:"Issue",name:this.editableIssue.name,fieldname:this.editableIssue})});if(s.ok){const e=await s.json();this.$emit("issue-updated",e.message),this.showEditModal=!1}else console.error("Failed to update issue"),alert("Failed to update issue. Please try again.")}catch(s){console.error("Error updating issue:",s),alert("Error updating issue. Please try again.")}},async updateStatus(){const s=prompt("Enter new status (Open, Replied, Resolved, Closed):",this.issue.status);if(s&&["Open","Replied","Resolved","Closed"].includes(s))try{const e=await fetch("/api/method/frappe.client.set_value",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":this.getCSRFToken()},body:JSON.stringify({doctype:"Issue",name:this.issue.name,fieldname:{status:s}})});if(e.ok){const o=await e.json();this.$emit("issue-updated",o.message)}else console.error("Failed to update issue status"),alert("Failed to update issue status. Please try again.")}catch(e){console.error("Error updating issue status:",e),alert("Error updating issue status. Please try again.")}},async deleteIssue(){if(confirm(`Are you sure you want to delete the issue "${this.issue.subject}"?`))try{(await fetch("/api/method/frappe.client.delete",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":this.getCSRFToken()},body:JSON.stringify({doctype:"Issue",name:this.issue.name})})).ok?this.$emit("close"):(console.error("Failed to delete issue"),alert("Failed to delete issue. Please try again."))}catch(s){console.error("Error deleting issue:",s),alert("Error deleting issue. Please try again.")}},priorityBadgeClasses(s){return{Low:"bg-green-100 text-green-800",Medium:"bg-yellow-100 text-yellow-800",High:"bg-orange-100 text-orange-800",Urgent:"bg-red-100 text-red-800"}[s]||"bg-gray-100 text-gray-800"},statusBadgeClasses(s){return{Open:"bg-blue-100 text-blue-800",Replied:"bg-purple-100 text-purple-800",Resolved:"bg-green-100 text-green-800",Closed:"bg-gray-100 text-gray-800"}[s]||"bg-gray-100 text-gray-800"},formatDate(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""},formatDateTime(s){return s?new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""},getCSRFToken(){const s=document.querySelector('meta[name="csrf-token"]');return s?s.getAttribute("content"):""}}},v={class:"p-6 border-b border-[#2a4a58] bg-[#2a4a58]"},w={class:"flex justify-between items-start"},h={class:"text-xl font-semibold text-white"},_={class:"text-sm text-gray-300 mt-1"},k={class:"p-6"},C={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6"},I={class:"lg:col-span-2 space-y-6"},S={class:"bg-[#2a4a58] rounded-lg p-4"},R=["innerHTML"],j={class:"bg-[#2a4a58] rounded-lg p-4"},T={class:"space-y-3"},D={class:"flex items-start space-x-3"},F={class:"flex-1"},E={class:"text-xs text-gray-400"},M={key:0,class:"flex items-start space-x-3"},N={class:"flex-1"},O={class:"text-xs text-gray-400"},U={key:1,class:"flex items-start space-x-3"},P={class:"flex-1"},A={class:"text-xs text-gray-400"},B={class:"space-y-6"},V={class:"bg-[#2a4a58] rounded-lg p-4"},L={class:"space-y-3"},H={class:"flex justify-between"},q={class:"flex justify-between"},J={class:"flex justify-between"},X={class:"text-sm text-white"},z={class:"bg-[#2a4a58] rounded-lg p-4"},G={class:"space-y-2"},K={class:"text-sm text-white"},Q={class:"text-sm text-white"},W={class:"text-sm text-white"},Y={class:"bg-[#2a4a58] rounded-lg p-4"},Z={class:"space-y-2"},$={class:"flex justify-between"},ee={class:"text-sm text-white"},te={key:0,class:"flex justify-between"},se={class:"text-sm text-white"},oe={key:1,class:"flex justify-between"},ie={class:"text-sm text-white"},le={class:"bg-[#2a4a58] rounded-lg p-4"},ne={class:"space-y-2"},de={class:"flex justify-between"},ae={class:"text-sm text-white"},re={class:"flex justify-between"},ue={class:"text-sm text-white"},me={class:"flex justify-between"},xe={class:"text-sm text-white"},be={class:"flex justify-end space-x-3 pt-6 border-t border-[#2a4a58]"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ce={class:"flex justify-end space-x-3 pt-6 border-t border-[#2a4a58]"};function fe(s,e,o,ye,l,d){return u(),r("div",{class:"bg-[#233d48] rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto border border-[#2a4a58]",onClick:e[15]||(e[15]=b(()=>{},["stop"]))},[t("div",v,[t("div",w,[t("div",null,[t("h3",h,n(o.issue.subject),1),t("p",_,n(o.issue.name),1)]),t("button",{onClick:e[0]||(e[0]=i=>s.$emit("close")),class:"text-gray-400 hover:text-white transition-colors duration-200"},[...e[16]||(e[16]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),t("div",k,[t("div",C,[t("div",I,[t("div",S,[e[17]||(e[17]=t("h4",{class:"text-lg font-medium text-white mb-3"},"Description",-1)),t("div",{class:"prose prose-invert max-w-none",innerHTML:o.issue.description||"No description provided"},null,8,R)]),t("div",j,[e[24]||(e[24]=t("h4",{class:"text-lg font-medium text-white mb-3"},"Activity",-1)),t("div",T,[t("div",D,[e[19]||(e[19]=t("div",{class:"flex-shrink-0 w-2 h-2 bg-[#8acc33] rounded-full mt-2"},null,-1)),t("div",F,[e[18]||(e[18]=t("p",{class:"text-sm text-white"},"Issue created",-1)),t("p",E,n(d.formatDateTime(o.issue.creation)),1)])]),o.issue.first_responded_on?(u(),r("div",M,[e[21]||(e[21]=t("div",{class:"flex-shrink-0 w-2 h-2 bg-blue-500 rounded-full mt-2"},null,-1)),t("div",N,[e[20]||(e[20]=t("p",{class:"text-sm text-white"},"First response sent",-1)),t("p",O,n(d.formatDateTime(o.issue.first_responded_on)),1)])])):m("",!0),o.issue.resolution_details?(u(),r("div",U,[e[23]||(e[23]=t("div",{class:"flex-shrink-0 w-2 h-2 bg-green-500 rounded-full mt-2"},null,-1)),t("div",P,[e[22]||(e[22]=t("p",{class:"text-sm text-white"},"Resolution provided",-1)),t("p",A,n(d.formatDateTime(o.issue.modified)),1)])])):m("",!0)])])]),t("div",B,[t("div",V,[e[28]||(e[28]=t("h4",{class:"text-lg font-medium text-white mb-3"},"Status",-1)),t("div",L,[t("div",H,[e[25]||(e[25]=t("span",{class:"text-sm text-gray-300"},"Current Status:",-1)),t("span",{class:p([d.statusBadgeClasses(o.issue.status),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},n(o.issue.status),3)]),t("div",q,[e[26]||(e[26]=t("span",{class:"text-sm text-gray-300"},"Priority:",-1)),t("span",{class:p([d.priorityBadgeClasses(o.issue.priority),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},n(o.issue.priority||"Not Set"),3)]),t("div",J,[e[27]||(e[27]=t("span",{class:"text-sm text-gray-300"},"Agreement Status:",-1)),t("span",X,n(o.issue.agreement_status||"N/A"),1)])])]),t("div",z,[e[32]||(e[32]=t("h4",{class:"text-lg font-medium text-white mb-3"},"Customer Information",-1)),t("div",G,[t("div",null,[e[29]||(e[29]=t("span",{class:"text-sm text-gray-300"},"Customer:",-1)),t("p",K,n(o.issue.customer||"N/A"),1)]),t("div",null,[e[30]||(e[30]=t("span",{class:"text-sm text-gray-300"},"Raised By:",-1)),t("p",Q,n(o.issue.raised_by),1)]),t("div",null,[e[31]||(e[31]=t("span",{class:"text-sm text-gray-300"},"Company:",-1)),t("p",W,n(o.issue.company||"N/A"),1)])])]),t("div",Y,[e[36]||(e[36]=t("h4",{class:"text-lg font-medium text-white mb-3"},"Dates",-1)),t("div",Z,[t("div",$,[e[33]||(e[33]=t("span",{class:"text-sm text-gray-300"},"Opened:",-1)),t("span",ee,n(d.formatDate(o.issue.opening_date)),1)]),o.issue.first_responded_on?(u(),r("div",te,[e[34]||(e[34]=t("span",{class:"text-sm text-gray-300"},"First Response:",-1)),t("span",se,n(d.formatDate(o.issue.first_responded_on)),1)])):m("",!0),o.issue.resolution_details?(u(),r("div",oe,[e[35]||(e[35]=t("span",{class:"text-sm text-gray-300"},"Resolved:",-1)),t("span",ie,n(d.formatDate(o.issue.modified)),1)])):m("",!0)])]),t("div",le,[e[40]||(e[40]=t("h4",{class:"text-lg font-medium text-white mb-3"},"Response Times",-1)),t("div",ne,[t("div",de,[e[37]||(e[37]=t("span",{class:"text-sm text-gray-300"},"First Response:",-1)),t("span",ae,n(o.issue.first_response_time||"N/A"),1)]),t("div",re,[e[38]||(e[38]=t("span",{class:"text-sm text-gray-300"},"Resolution:",-1)),t("span",ue,n(o.issue.resolution_time||"N/A"),1)]),t("div",me,[e[39]||(e[39]=t("span",{class:"text-sm text-gray-300"},"Avg Response:",-1)),t("span",xe,n(o.issue.avg_response_time||"N/A"),1)])])])])]),t("div",be,[t("button",{onClick:e[1]||(e[1]=(...i)=>d.editIssue&&d.editIssue(...i)),class:"px-4 py-2 border border-[#8acc33] text-[#8acc33] bg-[#233d48] hover:bg-[#2a4a58] rounded-md font-medium transition-colors duration-200"}," Edit Issue "),t("button",{onClick:e[2]||(e[2]=(...i)=>d.updateStatus&&d.updateStatus(...i)),class:"px-4 py-2 border border-[#8acc33] text-[#8acc33] bg-[#233d48] hover:bg-[#2a4a58] rounded-md font-medium transition-colors duration-200"}," Update Status "),t("button",{onClick:e[3]||(e[3]=(...i)=>d.deleteIssue&&d.deleteIssue(...i)),class:"px-4 py-2 border border-[#ef4444] text-[#ef4444] bg-[#233d48] hover:bg-[#2a4a58] rounded-md font-medium transition-colors duration-200"}," Delete ")])]),l.showEditModal?(u(),r("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:e[14]||(e[14]=i=>l.showEditModal=!1)},[t("div",{class:"bg-[#233d48] rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-[#2a4a58]",onClick:e[13]||(e[13]=b(()=>{},["stop"]))},[e[51]||(e[51]=t("div",{class:"p-6 border-b border-[#2a4a58] bg-[#2a4a58]"},[t("h3",{class:"text-xl font-semibold text-white"},"Edit Issue")],-1)),t("form",{onSubmit:e[12]||(e[12]=b((...i)=>d.saveIssue&&d.saveIssue(...i),["prevent"])),class:"p-6 space-y-6"},[t("div",pe,[t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Subject *",-1)),a(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=i=>l.editableIssue.subject=i),required:"",class:"w-full px-3 py-2 border border-[#2a4a58] rounded-md focus:outline-none focus:ring-2 focus:ring-[#8acc33] focus:border-transparent bg-[#233d48] text-white"},null,512),[[x,l.editableIssue.subject]])]),t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Customer",-1)),a(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=i=>l.editableIssue.customer=i),class:"w-full px-3 py-2 border border-[#2a4a58] rounded-md focus:outline-none focus:ring-2 focus:ring-[#8acc33] focus:border-transparent bg-[#233d48] text-white"},null,512),[[x,l.editableIssue.customer]])]),t("div",null,[e[44]||(e[44]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Priority",-1)),a(t("select",{"onUpdate:modelValue":e[6]||(e[6]=i=>l.editableIssue.priority=i),class:"w-full px-3 py-2 border border-[#2a4a58] rounded-md focus:outline-none focus:ring-2 focus:ring-[#8acc33] focus:border-transparent bg-[#233d48] text-white"},[...e[43]||(e[43]=[f('<option value="" data-v-749373db>Select Priority</option><option value="Low" data-v-749373db>Low</option><option value="Medium" data-v-749373db>Medium</option><option value="High" data-v-749373db>High</option><option value="Urgent" data-v-749373db>Urgent</option>',5)])],512),[[g,l.editableIssue.priority]])]),t("div",null,[e[46]||(e[46]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Status",-1)),a(t("select",{"onUpdate:modelValue":e[7]||(e[7]=i=>l.editableIssue.status=i),class:"w-full px-3 py-2 border border-[#2a4a58] rounded-md focus:outline-none focus:ring-2 focus:ring-[#8acc33] focus:border-transparent bg-[#233d48] text-white"},[...e[45]||(e[45]=[t("option",{value:"Open"},"Open",-1),t("option",{value:"Replied"},"Replied",-1),t("option",{value:"Resolved"},"Resolved",-1),t("option",{value:"Closed"},"Closed",-1)])],512),[[g,l.editableIssue.status]])])]),t("div",null,[e[47]||(e[47]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),a(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=i=>l.editableIssue.description=i),rows:"4",class:"w-full px-3 py-2 border border-[#2a4a58] rounded-md focus:outline-none focus:ring-2 focus:ring-[#8acc33] focus:border-transparent bg-[#233d48] text-white"},null,512),[[x,l.editableIssue.description]])]),t("div",ge,[t("div",null,[e[48]||(e[48]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Raised By",-1)),a(t("input",{type:"email","onUpdate:modelValue":e[9]||(e[9]=i=>l.editableIssue.raised_by=i),class:"w-full px-3 py-2 border border-[#2a4a58] rounded-md focus:outline-none focus:ring-2 focus:ring-[#8acc33] focus:border-transparent bg-[#233d48] text-white"},null,512),[[x,l.editableIssue.raised_by]])]),t("div",null,[e[49]||(e[49]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Resolution Details",-1)),a(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=i=>l.editableIssue.resolution_details=i),rows:"2",class:"w-full px-3 py-2 border border-[#2a4a58] rounded-md focus:outline-none focus:ring-2 focus:ring-[#8acc33] focus:border-transparent bg-[#233d48] text-white",placeholder:"Enter resolution details"},null,512),[[x,l.editableIssue.resolution_details]])])]),t("div",ce,[t("button",{type:"button",onClick:e[11]||(e[11]=i=>l.showEditModal=!1),class:"px-6 py-2 border border-[#8acc33] text-[#8acc33] bg-[#233d48] hover:bg-[#2a4a58] rounded-md font-medium transition-colors duration-200"}," Cancel "),e[50]||(e[50]=t("button",{type:"submit",class:"px-6 py-2 border border-[#8acc33] text-[#8acc33] bg-[#233d48] hover:bg-[#2a4a58] rounded-md font-medium transition-colors duration-200"}," Save Changes ",-1))])],32)])])):m("",!0)])}const we=c(y,[["render",fe],["__scopeId","data-v-749373db"]]);export{we as default};
//# sourceMappingURL=Issue-b96d5740.js.map
