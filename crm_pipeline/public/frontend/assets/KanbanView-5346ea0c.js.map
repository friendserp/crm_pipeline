{"version":3,"file":"KanbanView-5346ea0c.js","sources":["../../../../frontend/src/components/Icons/EmailAtIcon.vue","../../../../frontend/src/components/Kanban/KanbanView.vue"],"sourcesContent":["<template>\n  <svg\n    width=\"16\"\n    height=\"16\"\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M5.00915 1.67113C6.43756 0.996093 8.0523 0.824124 9.59083 1.18318L9.47719 1.67009L9.59083 1.18318C11.1294 1.54222 12.5012 2.41118 13.4833 3.64873L13.4833 3.64875C14.4653 4.8863 14.9999 6.41969 15 7.99959V7.99961V8.64961C15 9.29937 14.7419 9.92256 14.2824 10.382C13.8229 10.8415 13.1998 11.0996 12.55 11.0996C11.9002 11.0996 11.2771 10.8415 10.8176 10.382C10.6732 10.2376 10.5487 10.077 10.4458 9.90455C9.87852 10.6319 8.99387 11.0996 8.00001 11.0996C6.28792 11.0996 4.90001 9.71167 4.90001 7.99961C4.90001 6.28752 6.28792 4.8996 8.00001 4.8996C8.81015 4.8996 9.54773 5.21039 10.1 5.71924V5.3996C10.1 5.12346 10.3239 4.8996 10.6 4.8996C10.8761 4.8996 11.1 5.12346 11.1 5.3996V7.99961V8.64961C11.1 9.03414 11.2528 9.40298 11.5247 9.67491C11.7966 9.94684 12.1654 10.0996 12.55 10.0996C12.9345 10.0996 13.3034 9.94684 13.5753 9.67491C13.8472 9.40298 14 9.03414 14 8.64961V7.99964C14 7.99963 14 7.99962 14 7.99961C13.9999 6.64545 13.5417 5.33113 12.7 4.27036C11.8582 3.20959 10.6823 2.46476 9.36356 2.15701L9.477 1.67093L9.36356 2.15701C8.04482 1.84925 6.66077 1.99665 5.43641 2.57525L5.24134 2.16246L5.43641 2.57525C4.21207 3.15384 3.21944 4.12961 2.61996 5.34387C2.02048 6.55813 1.84939 7.93946 2.13451 9.26331C2.41962 10.5871 3.14418 11.7756 4.19038 12.6354C5.23657 13.4952 6.54286 13.9758 7.89687 13.9991C9.25083 14.0224 10.5729 13.587 11.648 12.7636C11.8673 12.5958 12.1811 12.6374 12.349 12.8566C12.5169 13.0759 12.4752 13.3897 12.256 13.5576C11.0017 14.5181 9.45929 15.0261 7.87968 14.999C6.30002 14.9718 4.77601 14.4111 3.55545 13.408L3.55543 13.408C2.33489 12.4048 1.48956 11.0183 1.15692 9.47385C0.824284 7.92937 1.02389 6.31782 1.72329 4.90118L2.16883 5.12114L1.72329 4.90117C2.42268 3.48454 3.58074 2.34615 5.00915 1.67113ZM10.1 7.99961C10.1 6.83981 9.15978 5.8996 8.00001 5.8996C6.84021 5.8996 5.90001 6.8398 5.90001 7.99961C5.90001 9.15939 6.84021 10.0996 8.00001 10.0996C9.15978 10.0996 10.1 9.15939 10.1 7.99961Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <div class=\"flex overflow-x-auto h-full\">\n    <Draggable\n      v-if=\"columns\"\n      :list=\"columns\"\n      item-key=\"column\"\n      @end=\"updateColumn\"\n      :delay=\"isTouchScreenDevice() ? 200 : 0\"\n      class=\"flex sm:mx-2.5 mx-2 pb-3.5\"\n    >\n      <template #item=\"{ element: column }\">\n        <div\n          v-if=\"!column.column.delete\"\n          class=\"flex flex-col gap-2.5 min-w-72 w-72 hover:bg-surface-gray-2 rounded-lg p-2.5\"\n        >\n          <div class=\"flex gap-2 items-center group justify-between\">\n            <div class=\"flex items-center text-base\">\n              <Popover>\n                <template #target=\"{ togglePopover }\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    class=\"hover:!bg-surface-gray-2\"\n                    @click=\"togglePopover\"\n                  >\n                    <IndicatorIcon :class=\"parseColor(column.column.color)\" />\n                  </Button>\n                </template>\n                <template #body>\n                  <div\n                    class=\"flex flex-col gap-3 px-3 py-2.5 min-w-40 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none\"\n                  >\n                    <div class=\"flex gap-1\">\n                      <Button\n                        variant=\"ghost\"\n                        v-for=\"color in colors\"\n                        :key=\"color\"\n                        @click=\"() => (column.column.color = color)\"\n                      >\n                        <IndicatorIcon :class=\"parseColor(color)\" />\n                      </Button>\n                    </div>\n                    <div class=\"flex flex-row-reverse\">\n                      <Button\n                        variant=\"solid\"\n                        :label=\"__('Apply')\"\n                        @click=\"updateColumn\"\n                      />\n                    </div>\n                  </div>\n                </template>\n              </Popover>\n              <div class=\"text-ink-gray-9\">{{ column.column.name }}</div>\n            </div>\n            <div class=\"flex\">\n              <Dropdown :options=\"actions(column)\">\n                <template #default>\n                  <Button\n                    class=\"opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto transition-opacity\"\n                    icon=\"more-horizontal\"\n                    variant=\"ghost\"\n                  />\n                </template>\n              </Dropdown>\n              <Button\n                icon=\"plus\"\n                variant=\"ghost\"\n                @click=\"options.onNewClick(column)\"\n              />\n            </div>\n          </div>\n          <div class=\"overflow-y-auto flex flex-col gap-2 h-full\">\n            <Draggable\n              :list=\"column.data\"\n              group=\"fields\"\n              item-key=\"name\"\n              class=\"flex flex-col gap-3.5 flex-1\"\n              @end=\"updateColumn\"\n              :delay=\"isTouchScreenDevice() ? 200 : 0\"\n              :data-column=\"column.column.name\"\n            >\n              <template #item=\"{ element: fields }\">\n                <component\n                  :is=\"options.getRoute ? 'router-link' : 'div'\"\n                  class=\"pt-3 px-3.5 pb-2.5 rounded-lg border bg-surface-white text-base flex flex-col text-ink-gray-9\"\n                  :data-name=\"fields.name\"\n                  v-bind=\"{\n                    to: options.getRoute ? options.getRoute(fields) : undefined,\n                    onClick: options.onClick\n                      ? () => options.onClick(fields)\n                      : undefined,\n                  }\"\n                >\n                  <slot\n                    name=\"title\"\n                    v-bind=\"{ fields, titleField, itemName: fields.name }\"\n                  >\n                    <div class=\"h-5 flex items-center\">\n                      <div v-if=\"fields[titleField]\">\n                        {{ fields[titleField] }}\n                      </div>\n                      <div class=\"text-ink-gray-4\" v-else>\n                        {{ __('No Title') }}\n                      </div>\n                    </div>\n                  </slot>\n                  <div class=\"border-b h-px my-2.5\" />\n\n                  <div class=\"flex flex-col gap-3.5\">\n                    <template v-for=\"value in column.fields\" :key=\"value\">\n                      <slot\n                        name=\"fields\"\n                        v-bind=\"{\n                          fields,\n                          fieldName: value,\n                          itemName: fields.name,\n                        }\"\n                      >\n                        <div v-if=\"fields[value]\" class=\"truncate\">\n                          {{ fields[value] }}\n                        </div>\n                      </slot>\n                    </template>\n                  </div>\n                  <div class=\"border-b h-px mt-2.5 mb-2\" />\n                  <slot name=\"actions\" v-bind=\"{ itemName: fields.name }\">\n                    <div class=\"flex gap-2 items-center justify-between\">\n                      <div></div>\n                      <Button icon=\"plus\" variant=\"ghost\" @click.stop.prevent />\n                    </div>\n                  </slot>\n                </component>\n              </template>\n            </Draggable>\n            <div\n              v-if=\"column.column.count < column.column.all_count\"\n              class=\"flex items-center justify-center\"\n            >\n              <Button\n                :label=\"__('Load More')\"\n                @click=\"emit('loadMore', column.column.name)\"\n              />\n            </div>\n          </div>\n        </div>\n      </template>\n    </Draggable>\n    <div v-if=\"deletedColumns.length\" class=\"shrink-0 min-w-64\">\n      <Autocomplete\n        value=\"\"\n        :options=\"deletedColumns\"\n        @change=\"(e) => addColumn(e)\"\n      >\n        <template #target=\"{ togglePopover }\">\n          <Button\n            class=\"w-full mt-2.5 mb-1 mr-5\"\n            :label=\"__('Add Column')\"\n            iconLeft=\"plus\"\n            @click=\"togglePopover()\"\n          />\n        </template>\n      </Autocomplete>\n    </div>\n  </div>\n</template>\n<script setup>\nimport Autocomplete from '@/components/frappe-ui/Autocomplete.vue'\nimport IndicatorIcon from '@/components/Icons/IndicatorIcon.vue'\nimport { isTouchScreenDevice, colors, parseColor } from '@/utils'\nimport Draggable from 'vuedraggable'\nimport { Dropdown, Popover } from 'frappe-ui'\nimport { computed } from 'vue'\n\nconst props = defineProps({\n  options: {\n    type: Object,\n    default: () => ({\n      getRoute: null,\n      onClick: null,\n      onNewClick: null,\n    }),\n  },\n})\n\nconst emit = defineEmits(['update', 'loadMore'])\n\nconst kanban = defineModel()\n\nconst titleField = computed(() => {\n  return kanban.value?.data?.title_field\n})\n\nconst columns = computed(() => {\n  if (!kanban.value?.data?.data || kanban.value.data.view_type != 'kanban')\n    return []\n  let _columns = kanban.value.data.data\n\n  let has_color = _columns.some((column) => column.column?.color)\n  if (!has_color) {\n    _columns.forEach((column, i) => {\n      column.column['color'] = colors[i % colors.length]\n    })\n  }\n  return _columns\n})\n\nconst deletedColumns = computed(() => {\n  return columns.value\n    .filter((col) => col.column['delete'])\n    .map((col) => {\n      return { label: col.column.name, value: col.column.name }\n    })\n})\n\nfunction actions(column) {\n  return [\n    {\n      group: __('Options'),\n      hideLabel: true,\n      items: [\n        {\n          label: __('Delete'),\n          icon: 'trash-2',\n          onClick: () => {\n            column.column['delete'] = true\n            updateColumn()\n          },\n        },\n      ],\n    },\n  ]\n}\n\nfunction addColumn(e) {\n  let column = columns.value.find((col) => col.column.name == e.value)\n  column.column['delete'] = false\n  updateColumn()\n}\n\nfunction updateColumn(d) {\n  let toColumn = d?.to?.dataset.column\n  let fromColumn = d?.from?.dataset.column\n  let itemName = d?.item?.dataset.name\n\n  let _columns = []\n  columns.value.forEach((col) => {\n    col.column['order'] = col.data.map((d) => d.name)\n    if (col.column.page_length) {\n      delete col.column.page_length\n    }\n    _columns.push(col.column)\n  })\n\n  let data = { kanban_columns: _columns }\n\n  if (toColumn != fromColumn) {\n    data = { item: itemName, to: toColumn, kanban_columns: _columns }\n  }\n\n  emit('update', data)\n}\n</script>\n"],"names":["_hoisted_1","_sfc_render","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","emit","__emit","kanban","_useModel","__props","titleField","computed","_b","_a","columns","_columns","column","i","colors","deletedColumns","col","actions","updateColumn","addColumn","d","toColumn","fromColumn","itemName","_c","data","_createBlock","_unref","Draggable","isTouchScreenDevice","_withCtx","_hoisted_2","_hoisted_3","_hoisted_4","_createVNode","Popover","togglePopover","_component_Button","IndicatorIcon","parseColor","_hoisted_5","_hoisted_6","_Fragment","_renderList","color","_normalizeClass","_hoisted_7","__","_hoisted_8","_toDisplayString","_hoisted_9","Dropdown","$event","_hoisted_10","fields","_resolveDynamicComponent","_mergeProps","_renderSlot","_normalizeProps","_guardReactiveProps","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","value","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","Autocomplete","e"],"mappings":"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"}