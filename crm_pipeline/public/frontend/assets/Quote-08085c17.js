import{_ as x,aU as h,a5 as g,a as r,b as t,t as s,n as y,e as d,F as m,f as _,g as l}from"./index-07f63b4e.js";const f={name:"QuotationDetail",setup(){const o=h(),e=g();return{route:o,router:e}},data(){return{quotation:null,loading:!1,error:null}},computed:{quotationId(){return console.log("Route params:",this.route.params),console.log("Quotation ID from route:",this.route.params.quoteId),this.route.params.quoteId},isExpiringSoon(){var c;if(!((c=this.quotation)!=null&&c.valid_till))return!1;const o=new Date(this.quotation.valid_till),e=new Date,u=new Date(e);return u.setDate(u.getDate()+7),o<=u&&o>=e}},watch:{"$route.params.id":{handler(o,e){o!==e&&this.loadQuotation()},immediate:!0}},async mounted(){console.log("Component mounted, quotationId:",this.quotationId),await this.loadQuotation()},methods:{goBack(){this.router.back()},async loadQuotation(){this.loading=!0,this.error=null;try{if(console.log("Loading quotation with ID:",this.quotationId),!this.quotationId)throw new Error("No quotation ID provided in route");const o=await fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":this.getCSRFToken()},body:JSON.stringify({doctype:"Quotation",name:this.quotationId})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const e=await o.json();e.message?this.quotation=e.message:await this.loadQuotationAlternative()}catch(o){console.error("Error loading quotation with primary method:",o),await this.loadQuotationAlternative()}finally{this.loading=!1}},async loadQuotationAlternative(){try{const o=await fetch(`/api/resource/Quotation/${encodeURIComponent(this.quotationId)}`,{method:"GET",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":this.getCSRFToken()}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const e=await o.json();this.quotation=e.data}catch(o){console.error("Error loading quotation with alternative method:",o),this.error=`Quotation "${this.quotationId}" not found`}},getCSRFToken(){var e;const o=((e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"))||"";return console.log("CSRF Token:",o?"Found":"Not found"),o},getStatusClass(o){return{Draft:"bg-gray-700 text-gray-300",Submitted:"bg-blue-900 text-blue-200",Lost:"bg-red-900 text-red-200",Ordered:"bg-green-900 text-green-200",Cancelled:"bg-red-900 text-red-200"}[o]||"bg-gray-700 text-gray-300"},formatDate(o){if(!o)return"Not set";try{return new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return"Invalid date"}},formatDateTime(o){if(!o)return"Not set";try{return new Date(o).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},formatCurrency(o){return`ETB ${parseFloat(o||0).toFixed(2)}`}}},p={class:"min-h-screen bg-[#233d48]"},v={key:0,class:"flex items-center justify-center min-h-screen"},b={key:1,class:"flex items-center justify-center min-h-screen"},w={class:"text-red-400 text-lg"},q={key:2},k={class:"bg-[#233d48] border-b border-[#2a4a58]"},C={class:"container mx-auto px-6 py-4"},D={class:"flex justify-between items-center"},T={class:"flex items-center space-x-4"},j={class:"text-2xl font-bold text-white"},S={class:"text-sm text-gray-300 mt-1"},I={class:"flex items-center gap-3"},Q={key:0,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-900 text-yellow-200"},F={class:"container mx-auto px-6 py-6"},E={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},B={class:"lg:col-span-2 space-y-6"},N={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-6"},R={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},L={class:"text-white font-medium"},A={class:"text-sm text-gray-400 mt-1"},O={class:"text-white"},P={class:"text-white"},U={class:"text-white"},G={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-6"},M={key:0,class:"text-center py-8 text-gray-400"},V={key:1,class:"space-y-4"},z={class:"flex items-start space-x-4"},H=["src","alt"],X={class:"flex-1"},J={class:"flex justify-between items-start"},K={class:"font-medium text-white"},W={class:"text-sm text-gray-400 mt-1"},Y={class:"text-sm text-gray-400 mt-1"},Z={class:"text-right"},$={class:"font-semibold text-white"},tt={class:"text-sm text-gray-400"},et={class:"mt-3 grid grid-cols-2 gap-4 text-sm text-gray-400"},st={key:0,class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-6"},ot={class:"space-y-3"},nt={class:"flex justify-between items-center"},it={class:"font-medium text-white"},at={class:"text-sm text-gray-400 mt-1"},rt={class:"text-right"},lt={class:"text-sm text-gray-300"},dt={class:"text-sm text-gray-400"},ut={class:"space-y-6"},ct={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-6"},mt={class:"space-y-3"},_t={class:"flex justify-between items-center"},xt={class:"font-semibold text-white"},ht={class:"flex justify-between items-center"},gt={class:"font-semibold text-white"},yt={class:"flex justify-between items-center"},ft={class:"font-semibold text-white"},pt={class:"border-t border-[#315566] pt-2"},vt={class:"flex justify-between items-center"},bt={class:"font-bold text-white text-lg"},wt={class:"text-center text-sm text-gray-400 mt-2"},qt={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-6"},kt={class:"space-y-3 text-sm"},Ct={class:"flex justify-between"},Dt={class:"text-white"},Tt={class:"flex justify-between"},jt={class:"text-white"},St={class:"flex justify-between"},It={class:"text-white"},Qt={class:"flex justify-between"},Ft={class:"text-white"},Et={class:"flex justify-between"},Bt={class:"text-white"},Nt={key:0,class:"flex justify-between"},Rt={class:"text-white"};function Lt(o,e,u,c,n,a){return l(),r("div",p,[n.loading?(l(),r("div",v,[...e[1]||(e[1]=[t("div",{class:"text-white text-lg"},"Loading quotation...",-1)])])):n.error?(l(),r("div",b,[t("div",w,s(n.error),1)])):n.quotation?(l(),r("div",q,[t("div",k,[t("div",C,[t("div",D,[t("div",T,[t("button",{onClick:e[0]||(e[0]=(...i)=>a.goBack&&a.goBack(...i)),class:"text-gray-300 hover:text-white"},[...e[2]||(e[2]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("div",null,[t("h1",j,"Quotation #"+s(n.quotation.name),1),t("div",S,s(n.quotation.customer_name)+" • "+s(a.formatDate(n.quotation.transaction_date)),1)])]),t("div",I,[t("span",{class:y(["inline-flex items-center px-3 py-1 rounded-full text-sm font-medium capitalize",a.getStatusClass(n.quotation.status)])},s(n.quotation.status),3),a.isExpiringSoon?(l(),r("span",Q," Expiring soon ")):d("",!0),e[3]||(e[3]=t("button",{class:"bg-[#2E86AB] text-white px-4 py-2 rounded-lg font-medium hover:bg-[#257195] transition-colors"}," Edit Quotation ",-1))])])])]),t("div",F,[t("div",E,[t("div",B,[t("div",N,[e[8]||(e[8]=t("h2",{class:"text-lg font-semibold text-white mb-4"},"Customer & Dates",-1)),t("div",R,[t("div",null,[e[4]||(e[4]=t("label",{class:"text-sm text-gray-300 block mb-2 font-medium"},"Customer",-1)),t("div",L,s(n.quotation.customer_name),1),t("div",A,s(n.quotation.quotation_to),1)]),t("div",null,[e[5]||(e[5]=t("label",{class:"text-sm text-gray-300 block mb-2 font-medium"},"Customer Group",-1)),t("div",O,s(n.quotation.customer_group),1)]),t("div",null,[e[6]||(e[6]=t("label",{class:"text-sm text-gray-300 block mb-2 font-medium"},"Transaction Date",-1)),t("div",P,s(a.formatDate(n.quotation.transaction_date)),1)]),t("div",null,[e[7]||(e[7]=t("label",{class:"text-sm text-gray-300 block mb-2 font-medium"},"Valid Till",-1)),t("div",U,s(a.formatDate(n.quotation.valid_till)),1)])])]),t("div",G,[e[9]||(e[9]=t("h2",{class:"text-lg font-semibold text-white mb-4"},"Items",-1)),n.quotation.items.length===0?(l(),r("div",M," No items in this quotation ")):(l(),r("div",V,[(l(!0),r(m,null,_(n.quotation.items,i=>(l(),r("div",{key:i.name,class:"bg-[#315566] border border-[#3a6374] rounded-lg p-4 hover:border-[#2E86AB] transition-colors"},[t("div",z,[i.image?(l(),r("img",{key:0,src:i.image,alt:i.item_name,class:"w-16 h-16 object-cover rounded-lg"},null,8,H)):d("",!0),t("div",X,[t("div",J,[t("div",null,[t("div",K,s(i.item_name),1),t("div",W,s(i.description),1),t("div",Y,"Code: "+s(i.item_code),1)]),t("div",Z,[t("div",$,s(a.formatCurrency(i.amount)),1),t("div",tt,s(i.qty)+" × "+s(a.formatCurrency(i.rate)),1)])]),t("div",et,[t("div",null,"UOM: "+s(i.uom),1),t("div",null,"Stock Qty: "+s(i.stock_qty),1)])])])]))),128))]))]),n.quotation.payment_schedule&&n.quotation.payment_schedule.length>0?(l(),r("div",st,[e[10]||(e[10]=t("h2",{class:"text-lg font-semibold text-white mb-4"},"Payment Schedule",-1)),t("div",ot,[(l(!0),r(m,null,_(n.quotation.payment_schedule,i=>(l(),r("div",{key:i.name,class:"bg-[#315566] border border-[#3a6374] rounded-lg p-4"},[t("div",nt,[t("div",null,[t("div",it,s(a.formatCurrency(i.payment_amount)),1),t("div",at,"Due: "+s(a.formatDate(i.due_date)),1)]),t("div",rt,[t("div",lt,s(i.invoice_portion)+"%",1),t("div",dt,"Outstanding: "+s(a.formatCurrency(i.outstanding)),1)])])]))),128))])])):d("",!0)]),t("div",ut,[t("div",ct,[e[15]||(e[15]=t("h3",{class:"font-semibold text-white mb-4"},"Financial Summary",-1)),t("div",mt,[t("div",_t,[e[11]||(e[11]=t("span",{class:"text-sm text-gray-300"},"Net Total",-1)),t("span",xt,s(a.formatCurrency(n.quotation.net_total)),1)]),t("div",ht,[e[12]||(e[12]=t("span",{class:"text-sm text-gray-300"},"Taxes",-1)),t("span",gt,s(a.formatCurrency(n.quotation.total_taxes_and_charges)),1)]),t("div",yt,[e[13]||(e[13]=t("span",{class:"text-sm text-gray-300"},"Discount",-1)),t("span",ft,s(a.formatCurrency(n.quotation.discount_amount)),1)]),t("div",pt,[t("div",vt,[e[14]||(e[14]=t("span",{class:"text-sm text-gray-300 font-medium"},"Grand Total",-1)),t("span",bt,s(a.formatCurrency(n.quotation.grand_total)),1)])]),t("div",wt,s(n.quotation.in_words),1)])]),t("div",qt,[e[22]||(e[22]=t("h3",{class:"font-semibold text-white mb-4"},"Quotation Information",-1)),t("div",kt,[t("div",Ct,[e[16]||(e[16]=t("span",{class:"text-gray-300"},"Company",-1)),t("span",Dt,s(n.quotation.company),1)]),t("div",Tt,[e[17]||(e[17]=t("span",{class:"text-gray-300"},"Currency",-1)),t("span",jt,s(n.quotation.currency),1)]),t("div",St,[e[18]||(e[18]=t("span",{class:"text-gray-300"},"Price List",-1)),t("span",It,s(n.quotation.selling_price_list),1)]),t("div",Qt,[e[19]||(e[19]=t("span",{class:"text-gray-300"},"Created",-1)),t("span",Ft,s(a.formatDateTime(n.quotation.creation)),1)]),t("div",Et,[e[20]||(e[20]=t("span",{class:"text-gray-300"},"Modified",-1)),t("span",Bt,s(a.formatDateTime(n.quotation.modified)),1)]),n.quotation.opportunity?(l(),r("div",Nt,[e[21]||(e[21]=t("span",{class:"text-gray-300"},"Opportunity",-1)),t("span",Rt,s(n.quotation.opportunity),1)])):d("",!0)])])])])])])):d("",!0)])}const Ot=x(f,[["render",Lt]]);export{Ot as default};
//# sourceMappingURL=Quote-08085c17.js.map
