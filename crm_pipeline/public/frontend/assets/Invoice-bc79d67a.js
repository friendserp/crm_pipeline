import{_ as x,aU as g,a5 as p,a,b as t,t as i,F as u,f as m,e as c,n as y,a4 as f,g as d}from"./index-07f63b4e.js";const v={name:"Invoice",setup(){const s=g(),e=p();return{route:s,router:e}},data(){return{invoice:null,showEditModal:!1,loading:!0,error:null}},async mounted(){await this.fetchInvoice()},methods:{async fetchInvoice(){this.loading=!0,this.error=null;try{const s=this.route.params.invoiceId;console.log("Route params:",this.route.params),console.log("Fetching invoice:",s);const e=await fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":await this.getCSRFToken()},body:JSON.stringify({doctype:"Sales Invoice",name:s})});if(e.ok){const l=await e.json();l.message?this.invoice=l.message:this.error="Invoice not found"}else{const l=await e.json();this.error=l.message||"Failed to fetch invoice details"}}catch(s){console.error("Error fetching invoice:",s),this.error="Network error while fetching invoice"}finally{this.loading=!1}},editInvoice(){this.showEditModal=!0},saveEdit(){this.showEditModal=!1,alert("Invoice updated successfully!")},async deleteInvoice(){if(confirm(`Are you sure you want to delete the invoice "${this.invoice.name}"?`))try{const s=await fetch("/api/method/frappe.client.delete",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":await this.getCSRFToken()},body:JSON.stringify({doctype:"Sales Invoice",name:this.invoice.name})});if(s.ok)this.router.push("/invoices");else{const e=await s.json();console.error("Failed to delete invoice:",e),alert("Failed to delete invoice. Please try again.")}}catch(s){console.error("Error deleting invoice:",s),alert("Error deleting invoice. Please try again.")}},getBillingAddress(){return this.invoice.address_display||"Address not available"},getContactDetails(){return this.invoice.contact_display||"Contact details not available"},getPaymentTerms(){return this.invoice.payment_terms_template||"Net 30"},formatDate(s){if(!s)return"Not set";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid date"}},formatDateTime(s){if(!s)return"Not set";try{return new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},formatNumber(s){if(!s&&s!==0)return"0";try{return parseFloat(s).toLocaleString("en-US")}catch{return"0"}},formatCurrency(s){if(!s&&s!==0)return"ETB 0.00";try{return`ETB ${parseFloat(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}catch{return"ETB 0.00"}},statusBadgeClasses(s){return{Draft:"bg-gray-100 text-gray-800",Unpaid:"bg-yellow-100 text-yellow-800",Paid:"bg-green-100 text-green-800",Return:"bg-purple-100 text-purple-800",Overdue:"bg-red-100 text-red-800",Cancelled:"bg-gray-100 text-gray-800"}[s]||"bg-gray-100 text-gray-800"},async getCSRFToken(){try{return(await(await fetch("/api/method/frappe.csrf_token.get_csrf_token")).json()).message.csrf_token}catch(s){return console.error("Error getting CSRF token:",s),""}}}},h={class:"min-h-screen bg-[#233d48] py-6"},b={class:"max-w-6xl mx-auto px-4"},_={key:0,class:"flex justify-center items-center py-12"},w={key:1,class:"text-center py-12"},C={class:"text-gray-400 mb-4"},k={key:2,class:"space-y-6"},S={class:"flex justify-between items-center mb-6"},I={class:"text-2xl font-bold text-white"},j={class:"text-gray-300"},D={class:"flex space-x-3"},F={class:"bg-[#233d48] rounded-lg shadow-xl border border-[#2a4a58]"},E={class:"p-6 space-y-6"},T={class:"bg-[#2a4a58] p-4 rounded-lg border border-[#2a4a58]"},N={class:"text-gray-300"},B={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},R={class:"bg-[#2a4a58] p-4 rounded-lg border border-[#2a4a58]"},P={class:"text-gray-300"},M={class:"text-gray-300 whitespace-pre-line"},A={class:"bg-[#2a4a58] p-4 rounded-lg border border-[#2a4a58] space-y-4"},L={class:"text-white"},O={class:"text-white"},U={class:"bg-[#2a4a58] rounded-lg border border-[#2a4a58] overflow-hidden"},z={class:"w-full"},J={class:"py-3 px-4 text-white"},V={class:"py-3 px-4 text-white"},X={class:"py-3 px-4 text-gray-300"},q={class:"py-3 px-4 text-white text-center"},Q={class:"py-3 px-4 text-gray-300 text-center"},G={class:"py-3 px-4 text-white text-right"},H={class:"py-3 px-4 text-white text-right"},K={key:0},W={key:0},Y={class:"border-t border-[#233d48] bg-[#233d48]"},Z={class:"py-3 px-4 text-right text-white font-medium"},$={class:"py-3 px-4 text-right text-white font-medium"},tt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},et={class:"bg-[#2a4a58] p-4 rounded-lg border border-[#2a4a58] space-y-3"},st={class:"flex justify-between"},ot={class:"text-white"},it={class:"flex justify-between"},rt={class:"text-white"},nt={class:"flex justify-between"},at={class:"text-white"},dt={class:"flex justify-between border-t border-[#233d48] pt-3"},lt={class:"text-white font-medium"},ct={class:"flex justify-between"},ut={class:"text-white"},mt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},xt={class:"bg-[#2a4a58] p-4 rounded-lg border border-[#2a4a58]"},gt={class:"flex justify-between text-sm"},pt={class:"text-white"},yt={class:"flex justify-between text-sm"},ft={class:"text-white"},vt={key:0,class:"text-gray-400 text-sm"},ht={class:"bg-[#2a4a58] p-4 rounded-lg border border-[#2a4a58] space-y-2"},bt={class:"flex justify-between"},_t={class:"flex justify-between"},wt={class:"text-white"},Ct={class:"flex justify-between"},kt={class:"text-white"},St={class:"flex justify-between"},It={class:"text-white"},jt={class:"p-6"},Dt={class:"flex justify-end space-x-3 mt-6"};function Ft(s,e,l,Et,o,r){return d(),a("div",h,[t("div",b,[o.loading?(d(),a("div",_,[...e[7]||(e[7]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8acc33]"},null,-1)])])):o.error?(d(),a("div",w,[e[8]||(e[8]=t("div",{class:"text-red-400 mb-4"},[t("svg",{class:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e[9]||(e[9]=t("h3",{class:"text-lg font-medium text-white mb-2"},"Failed to load invoice",-1)),t("p",C,i(o.error),1),t("button",{onClick:e[0]||(e[0]=n=>s.$router.back()),class:"px-4 py-2 border border-[#8acc33] text-[#8acc33] bg-[#233d48] hover:bg-[#2a4a58] rounded-md font-medium transition-colors duration-200"}," Back to Invoices ")])):o.invoice?(d(),a("div",k,[t("div",S,[t("div",null,[t("h2",I,"Invoice for "+i(o.invoice.customer_name),1),t("p",j,i(o.invoice.name),1)]),t("div",D,[t("button",{onClick:e[1]||(e[1]=n=>s.$router.back()),class:"px-4 py-2 border border-[#8acc33] text-[#8acc33] bg-[#233d48] hover:bg-[#2a4a58] rounded-md font-medium transition-colors duration-200"}," Back to Invoices "),t("button",{onClick:e[2]||(e[2]=(...n)=>r.deleteInvoice&&r.deleteInvoice(...n)),class:"px-4 py-2 bg-red-600 text-white rounded-md font-medium transition-colors duration-200 hover:bg-red-700"}," Delete Invoice ")])]),t("div",F,[t("div",E,[t("div",null,[e[11]||(e[11]=t("h4",{class:"text-lg font-medium text-white mb-4"},"Invoice subject",-1)),t("div",T,[e[10]||(e[10]=t("p",{class:"text-[#8acc33] font-medium"},"Subject",-1)),t("p",N,i(o.invoice.title||"For Services Rendered"),1)])]),t("div",B,[t("div",null,[e[15]||(e[15]=t("h4",{class:"text-lg font-medium text-white mb-4"},"Billing address",-1)),t("div",R,[t("p",P,i(r.getBillingAddress()),1),e[12]||(e[12]=t("p",{class:"text-[#8acc33] font-medium mt-2"},"Property Address",-1)),e[13]||(e[13]=t("p",{class:"text-gray-300"},"(Same as billing address)",-1)),e[14]||(e[14]=t("p",{class:"text-[#8acc33] font-medium mt-2"},"Contact details",-1)),t("p",M,i(r.getContactDetails()),1)])]),t("div",null,[e[18]||(e[18]=t("h4",{class:"text-lg font-medium text-white mb-4"},"Invoice details",-1)),t("div",A,[t("div",null,[e[16]||(e[16]=t("p",{class:"text-gray-300"},"Issued date:",-1)),t("p",L,i(r.formatDate(o.invoice.posting_date)||"Date Sent"),1)]),t("div",null,[e[17]||(e[17]=t("p",{class:"text-gray-300"},"Payment due:",-1)),t("p",O,i(r.getPaymentTerms()),1)])])])]),t("div",null,[e[22]||(e[22]=t("h4",{class:"text-lg font-medium text-white mb-4"},"Product / Service",-1)),t("div",U,[t("table",z,[e[21]||(e[21]=t("thead",null,[t("tr",{class:"border-b border-[#233d48]"},[t("th",{class:"text-left py-3 px-4 text-gray-300 font-medium"},"Item Code"),t("th",{class:"text-left py-3 px-4 text-gray-300 font-medium"},"Item Name"),t("th",{class:"text-left py-3 px-4 text-gray-300 font-medium"},"Description"),t("th",{class:"text-left py-3 px-4 text-gray-300 font-medium"},"Qty"),t("th",{class:"text-left py-3 px-4 text-gray-300 font-medium"},"UOM"),t("th",{class:"text-left py-3 px-4 text-gray-300 font-medium"},"Rate"),t("th",{class:"text-left py-3 px-4 text-gray-300 font-medium"},"Amount")])],-1)),t("tbody",null,[(d(!0),a(u,null,m(o.invoice.items,n=>(d(),a("tr",{key:n.name,class:"border-b border-[#233d48] hover:bg-[#233d48] transition-colors duration-150"},[t("td",J,i(n.item_code),1),t("td",V,i(n.item_name),1),t("td",X,i(n.description||"-"),1),t("td",q,i(r.formatNumber(n.qty)),1),t("td",Q,i(n.uom||n.stock_uom||"Nos"),1),t("td",G,i(r.formatCurrency(n.rate)),1),t("td",H,i(r.formatCurrency(n.amount)),1)]))),128)),!o.invoice.items||o.invoice.items.length===0?(d(),a("tr",K,[...e[19]||(e[19]=[t("td",{colspan:"7",class:"py-4 px-4 text-center text-gray-400"}," No items added ",-1)])])):c("",!0)]),o.invoice.items&&o.invoice.items.length>0?(d(),a("tfoot",W,[t("tr",Y,[e[20]||(e[20]=t("td",{colspan:"5",class:"py-3 px-4 text-right text-gray-300 font-medium"},"Total:",-1)),t("td",Z,i(r.formatCurrency(o.invoice.net_total)),1),t("td",$,i(r.formatCurrency(o.invoice.grand_total)),1)])])):c("",!0)])])]),t("div",tt,[e[28]||(e[28]=t("div",null,[t("div",{class:"flex items-center"},[t("input",{type:"checkbox",class:"mr-2"}),t("span",{class:"text-gray-300 text-sm"},"Client view Change")])],-1)),t("div",et,[t("div",st,[e[23]||(e[23]=t("span",{class:"text-gray-300"},"Subtotal",-1)),t("span",ot,i(r.formatCurrency(o.invoice.net_total)),1)]),t("div",it,[e[24]||(e[24]=t("span",{class:"text-gray-300"},"Discount",-1)),t("span",rt,i(r.formatCurrency(o.invoice.discount_amount)),1)]),t("div",nt,[e[25]||(e[25]=t("span",{class:"text-gray-300"},"Tax",-1)),t("span",at,i(r.formatCurrency(o.invoice.total_taxes_and_charges)),1)]),t("div",dt,[e[26]||(e[26]=t("span",{class:"text-white font-medium"},"Total",-1)),t("span",lt,i(r.formatCurrency(o.invoice.grand_total)),1)]),t("div",ct,[e[27]||(e[27]=t("span",{class:"text-gray-300"},"Outstanding Amount",-1)),t("span",ut,i(r.formatCurrency(o.invoice.outstanding_amount)),1)])])]),t("div",mt,[t("div",null,[e[31]||(e[31]=t("h4",{class:"text-lg font-medium text-white mb-4"},"Payment Schedule",-1)),t("div",xt,[(d(!0),a(u,null,m(o.invoice.payment_schedule,n=>(d(),a("div",{key:n.name,class:"border-b border-[#233d48] last:border-b-0 pb-2 mb-2 last:pb-0 last:mb-0"},[t("div",gt,[e[29]||(e[29]=t("span",{class:"text-gray-300"},"Due Date:",-1)),t("span",pt,i(r.formatDate(n.due_date)),1)]),t("div",yt,[e[30]||(e[30]=t("span",{class:"text-gray-300"},"Amount:",-1)),t("span",ft,i(r.formatCurrency(n.payment_amount)),1)])]))),128)),!o.invoice.payment_schedule||o.invoice.payment_schedule.length===0?(d(),a("div",vt," No payment schedule defined ")):c("",!0)])]),t("div",null,[e[36]||(e[36]=t("h4",{class:"text-lg font-medium text-white mb-4"},"Status Information",-1)),t("div",ht,[t("div",bt,[e[32]||(e[32]=t("span",{class:"text-gray-300"},"Status:",-1)),t("span",{class:y([r.statusBadgeClasses(o.invoice.status),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},i(o.invoice.status),3)]),t("div",_t,[e[33]||(e[33]=t("span",{class:"text-gray-300"},"Company:",-1)),t("span",wt,i(o.invoice.company),1)]),t("div",Ct,[e[34]||(e[34]=t("span",{class:"text-gray-300"},"Currency:",-1)),t("span",kt,i(o.invoice.currency),1)]),t("div",St,[e[35]||(e[35]=t("span",{class:"text-gray-300"},"Last Modified:",-1)),t("span",It,i(r.formatDateTime(o.invoice.modified)),1)])])])])])]),o.showEditModal?(d(),a("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:e[6]||(e[6]=n=>o.showEditModal=!1)},[t("div",{class:"bg-[#233d48] rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto border border-[#2a4a58]",onClick:e[5]||(e[5]=f(()=>{},["stop"]))},[t("div",jt,[e[37]||(e[37]=t("h3",{class:"text-xl font-semibold text-white mb-4"},"Edit Invoice",-1)),e[38]||(e[38]=t("p",{class:"text-gray-300"},"Edit functionality would be implemented here...",-1)),t("div",Dt,[t("button",{onClick:e[3]||(e[3]=n=>o.showEditModal=!1),class:"px-6 py-2 border border-[#8acc33] text-[#8acc33] bg-[#233d48] hover:bg-[#2a4a58] rounded-md font-medium transition-colors duration-200"}," Cancel "),t("button",{onClick:e[4]||(e[4]=(...n)=>r.saveEdit&&r.saveEdit(...n)),class:"px-6 py-2 bg-[#8acc33] text-white rounded-md font-medium transition-colors duration-200"}," Save Changes ")])])])])):c("",!0)])):c("",!0)])])}const Nt=x(v,[["render",Ft]]);export{Nt as default};
//# sourceMappingURL=Invoice-bc79d67a.js.map
