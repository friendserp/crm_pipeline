import{_ as h,a5 as v,a as l,d as p,b as t,t as i,J as m,a2 as g,F as x,f,e as _,g as d,n as b}from"./index-07f63b4e.js";const y={name:"Quotations",setup(){return{router:v()}},data(){return{quotations:[],filters:{status:"all",customer:"all",dateRange:"all"},overview:{expiring_soon:0,draft:0,submitted:0,lost:0,ordered:0},loading:!1}},computed:{filteredQuotations(){return this.quotations.filter(s=>{if(this.filters.status!=="all"&&s.status!==this.filters.status||this.filters.customer!=="all"&&s.customer_name!==this.filters.customer)return!1;if(this.filters.dateRange!=="all"){const e=new Date(s.transaction_date),r=new Date;switch(this.filters.dateRange){case"today":return e.toDateString()===r.toDateString();case"week":const u=new Date(r.setDate(r.getDate()-7));return e>=u;case"month":const a=new Date(r.setMonth(r.getMonth()-1));return e>=a}}return!0})},recentQuotations(){const s=new Date;return s.setDate(s.getDate()-30),this.quotations.filter(e=>new Date(e.transaction_date)>=s).slice(0,5)},uniqueCustomers(){return[...new Set(this.quotations.map(s=>s.customer_name))].sort()}},async mounted(){await this.loadQuotations(),this.calculateOverview()},watch:{filters:{handler(){this.calculateOverview()},deep:!0}},methods:{viewQuotation(s){this.router.push(`/quotes/${s}`)},async loadQuotations(){this.loading=!0;try{const s=await fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":this.getCSRFToken()},body:JSON.stringify({doctype:"Quotation",fields:["name","customer_name","quotation_to","transaction_date","valid_till","grand_total","currency","status","items","company","modified"],limit_page_length:100,order_by:"modified desc"})});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const e=await s.json();this.quotations=e.message||[]}catch(s){console.error("Error loading quotations:",s),this.quotations=[]}finally{this.loading=!1}},getCSRFToken(){var s;return((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},calculateOverview(){const s=new Date,e=new Date(s);e.setDate(e.getDate()+7),this.overview={expiring_soon:this.quotations.filter(r=>{if(!r.valid_till)return!1;const u=new Date(r.valid_till);return u<=e&&u>=s&&r.status==="Submitted"}).length,draft:this.quotations.filter(r=>r.status==="Draft").length,submitted:this.quotations.filter(r=>r.status==="Submitted").length,lost:this.quotations.filter(r=>r.status==="Lost").length,ordered:this.quotations.filter(r=>r.status==="Ordered").length}},getStatusClass(s){return{Draft:"bg-gray-700 text-gray-300",Submitted:"bg-blue-900 text-blue-200",Lost:"bg-red-900 text-red-200",Ordered:"bg-green-900 text-green-200",Cancelled:"bg-red-900 text-red-200"}[s]||"bg-gray-700 text-gray-300"},getStatusColor(s){return{Draft:"bg-gray-500",Submitted:"bg-blue-500",Lost:"bg-red-500",Ordered:"bg-green-500",Cancelled:"bg-red-500"}[s]||"bg-gray-500"},formatDate(s){if(!s)return"Not set";try{return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return"Invalid date"}},formatCurrency(s){return`ETB ${parseFloat(s||0).toFixed(2)}`}}},w={class:"w-full min-h-screen bg-[#233d48]"},D={class:"container mx-auto px-6 py-6"},S={class:"mb-8"},C={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},k={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-4 hover:border-[#2E86AB] transition-colors"},A={class:"text-xl font-semibold text-white"},Q={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-4 hover:border-[#2E86AB] transition-colors"},E={class:"text-xl font-semibold text-yellow-400"},T={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-4 hover:border-[#2E86AB] transition-colors"},B={class:"text-xl font-semibold text-blue-400"},R={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-4 hover:border-[#2E86AB] transition-colors"},F={class:"text-xl font-semibold text-red-400"},O={class:"bg-[#2a4a58] rounded-lg border border-[#315566] p-4 hover:border-[#2E86AB] transition-colors"},q={class:"text-xl font-semibold text-green-400"},L={class:"bg-[#2a4a58] rounded-lg border border-[#315566]"},N={class:"p-6 border-b border-[#315566]"},V={class:"flex justify-between items-center"},j={class:"text-sm text-gray-300 mt-1"},M={class:"p-6 border-b border-[#315566] bg-[#315566]"},U={class:"flex flex-wrap gap-6"},z=["value"],J={class:"overflow-x-auto"},P={class:"w-full"},H={class:"divide-y divide-[#315566]"},I={key:0},W={key:1},X=["onClick"],G={class:"py-4 px-6"},K={class:"flex items-center space-x-3"},Y={class:"font-medium text-white group-hover:text-[#2E86AB] transition-colors"},Z={class:"text-sm text-gray-400 mt-1"},$={class:"py-4 px-6"},tt={class:"text-white"},et={class:"text-sm text-gray-400"},st={class:"py-4 px-6"},ot={class:"text-sm text-white"},rt={class:"text-sm text-gray-400"},it={class:"py-4 px-6"},at={class:"py-4 px-6"},nt={class:"font-medium text-white"},lt={class:"text-sm text-gray-400"};function dt(s,e,r,u,a,n){return d(),l("div",w,[e[15]||(e[15]=p('<div class="bg-[#233d48] border-b border-[#2a4a58]"><div class="container mx-auto px-6 py-4"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold text-white">Quotations</h1><button class="bg-[#2E86AB] text-white px-4 py-2 rounded-lg font-medium hover:bg-[#257195] transition-colors"> Create Quotation </button></div></div></div>',1)),t("div",D,[t("div",S,[t("div",C,[t("div",k,[e[2]||(e[2]=t("div",{class:"text-sm text-gray-300"},"Expiring soon",-1)),t("div",A,i(a.overview.expiring_soon),1)]),t("div",Q,[e[3]||(e[3]=t("div",{class:"text-sm text-gray-300"},"Draft",-1)),t("div",E,i(a.overview.draft),1)]),t("div",T,[e[4]||(e[4]=t("div",{class:"text-sm text-gray-300"},"Submitted",-1)),t("div",B,i(a.overview.submitted),1)]),t("div",R,[e[5]||(e[5]=t("div",{class:"text-sm text-gray-300"},"Lost",-1)),t("div",F,i(a.overview.lost),1)]),t("div",O,[e[6]||(e[6]=t("div",{class:"text-sm text-gray-300"},"Ordered",-1)),t("div",q,i(a.overview.ordered),1)])])]),t("div",L,[t("div",N,[t("div",V,[t("div",null,[e[7]||(e[7]=t("h2",{class:"text-lg font-semibold text-white"},"All quotations",-1)),t("div",j,"("+i(n.filteredQuotations.length)+" results)",1)])])]),t("div",M,[t("div",U,[t("div",null,[e[9]||(e[9]=t("label",{class:"text-sm text-gray-300 block mb-2 font-medium"},"Customer",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.filters.customer=o),class:"bg-[#233d48] border border-[#315566] text-white rounded-lg px-4 py-2 text-sm w-40 focus:outline-none focus:ring-2 focus:ring-[#2E86AB] focus:border-transparent"},[e[8]||(e[8]=t("option",{value:"all"},"All",-1)),(d(!0),l(x,null,f(n.uniqueCustomers,o=>(d(),l("option",{key:o,value:o},i(o),9,z))),128))],512),[[g,a.filters.customer]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"text-sm text-gray-300 block mb-2 font-medium"},"Date Range",-1)),m(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>a.filters.dateRange=o),class:"bg-[#233d48] border border-[#315566] text-white rounded-lg px-4 py-2 text-sm w-40 focus:outline-none focus:ring-2 focus:ring-[#2E86AB] focus:border-transparent"},[...e[10]||(e[10]=[t("option",{value:"all"},"All Time",-1),t("option",{value:"today"},"Today",-1),t("option",{value:"week"},"This Week",-1),t("option",{value:"month"},"This Month",-1)])],512),[[g,a.filters.dateRange]])])])]),t("div",J,[t("table",P,[e[14]||(e[14]=t("thead",{class:"bg-[#315566] border-b border-[#315566]"},[t("tr",null,[t("th",{class:"text-left py-4 px-6 text-sm font-medium text-gray-300"},"Quotation"),t("th",{class:"text-left py-4 px-6 text-sm font-medium text-gray-300"},"Customer"),t("th",{class:"text-left py-4 px-6 text-sm font-medium text-gray-300"},"Date"),t("th",{class:"text-left py-4 px-6 text-sm font-medium text-gray-300"},"Status"),t("th",{class:"text-left py-4 px-6 text-sm font-medium text-gray-300"},"Total")])],-1)),t("tbody",H,[a.loading?(d(),l("tr",I,[...e[12]||(e[12]=[t("td",{colspan:"5",class:"text-center py-8 text-gray-400"}," Loading quotations... ",-1)])])):n.filteredQuotations.length===0?(d(),l("tr",W,[...e[13]||(e[13]=[t("td",{colspan:"5",class:"text-center py-8 text-gray-400"}," No quotations found ",-1)])])):_("",!0),(d(!0),l(x,null,f(n.filteredQuotations,o=>{var c;return d(),l("tr",{key:o.name,class:"hover:bg-[#315566] cursor-pointer transition-colors group",onClick:ut=>n.viewQuotation(o.name)},[t("td",G,[t("div",K,[t("div",{class:b(["flex-shrink-0 w-2 h-2 rounded-full",n.getStatusColor(o.status)])},null,2),t("div",null,[t("div",Y," #"+i(o.name),1),t("div",Z,i(((c=o.items)==null?void 0:c.length)||0)+" items ",1)])])]),t("td",$,[t("div",tt,i(o.customer_name),1),t("div",et,i(o.quotation_to),1)]),t("td",st,[t("div",ot,i(n.formatDate(o.transaction_date)),1),t("div",rt,"Valid till: "+i(n.formatDate(o.valid_till)),1)]),t("td",it,[t("span",{class:b(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize",n.getStatusClass(o.status)])},i(o.status),3)]),t("td",at,[t("div",nt,i(n.formatCurrency(o.grand_total)),1),t("div",lt,i(o.currency),1)])],8,X)}),128))])])])])])])}const mt=h(y,[["render",dt]]);export{mt as default};
//# sourceMappingURL=Quotes-37273c50.js.map
