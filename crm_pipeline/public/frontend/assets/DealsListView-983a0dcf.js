import{M as V,aU as N,N as $,c as x,aR as T,v as q,r as P,V as w,g as s,a as r,L as n,H as c,O as d,F as M,f as H,G as m,n as p,e as k,a4 as O,$ as S,b as j,t as B}from"./index-07f63b4e.js";import{H as F,_ as E}from"./ListBulkActions-84d4d198.js";import{_ as G}from"./statuses-969fdf55.js";import{I as J}from"./modals-49388916.js";import{P as K}from"./PhoneIcon-2a8d1724.js";import{_ as Q,a as X,b as Y,c as Z,d as ee,e as te}from"./DeleteLinkedDocModal-c0fc932d.js";import{b as L,D as se}from"./UserAvatar-7e2b021e.js";import{_ as le}from"./ListFooter-a4fa878a.js";const oe={key:0,class:"flex items-center"},ae={key:0},ne={key:1},ie={key:2},re={key:3},de={key:4},ue=["onClick"],ce={key:1,class:"truncate text-base"},me={key:2},ke=["onClick"],ge={__name:"DealsListView",props:V({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:V(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(a,{expose:z,emit:U}){const u=U,g=N(),y=$(a,"modelValue"),_=$(a,"list"),A=x(()=>{var i,l;return!!((l=(i=_.value.params)==null?void 0:i.filters)!=null&&l._liked_by)}),{user:D}=T();function h(i){if(i)return JSON.parse(i).includes(D)}q(y,(i,l)=>{i!==l&&u("updatePageCount",i)});const C=P(null);return z({customListActions:x(()=>{var i;return(i=C.value)==null?void 0:i.customListActions})}),(i,l)=>{const v=w("Button"),R=w("Badge"),I=w("FormControl");return s(),r(M,null,[n(d(te),{class:p(i.$attrs.class),columns:a.columns,rows:a.rows,options:{getRowRoute:e=>({name:"Deal",params:{dealId:e.name},query:{view:d(g).query.view,viewType:d(g).params.viewType}}),selectable:a.options.selectable,showTooltip:a.options.showTooltip,resizeColumn:a.options.resizeColumn},"row-key":"name","onUpdate:selections":l[2]||(l[2]=e=>u("selectionsChanged",e))},{default:c(()=>[n(d(Q),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:l[1]||(l[1]=e=>u("columnWidthUpdated"))},{default:c(()=>[(s(!0),r(M,null,H(a.columns,e=>(s(),m(d(X),{key:e.key,item:e,onColumnWidthUpdated:o=>u("columnWidthUpdated",e)},{default:c(()=>[e.key=="_liked_by"?(s(),m(v,{key:0,variant:"ghosted",class:p(["!h-4",A.value?"fill-red-500":"fill-white"]),onClick:l[0]||(l[0]=()=>u("applyLikeFilter"))},{default:c(()=>[n(F,{class:"h-4 w-4"})]),_:1},8,["class"])):k("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),n(Y,{rows:a.rows,doctype:"CRM Deal"},{default:c(({idx:e,column:o,item:t,row:W})=>[o.key==="_assign"?(s(),r("div",oe,[n(G,{avatars:t,size:"sm",onClick:b=>u("applyFilter",{event:b,idx:e,column:o,item:t,firstColumn:a.columns[0]})},null,8,["avatars","onClick"])])):(s(),m(d(Z),{key:1,item:t,align:o.align},{prefix:c(()=>[o.key==="status"?(s(),r("div",ae,[n(J,{class:p(t.color)},null,8,["class"])])):o.key==="organization"?(s(),r("div",ne,[t.label?(s(),m(d(L),{key:0,class:"flex items-center",image:t.logo,label:t.label,size:"sm"},null,8,["image","label"])):k("",!0)])):o.key==="deal_owner"?(s(),r("div",ie,[t.full_name?(s(),m(d(L),{key:0,class:"flex items-center",image:t.user_image,label:t.full_name,size:"sm"},null,8,["image","label"])):k("",!0)])):o.key==="mobile_no"?(s(),r("div",re,[n(K,{class:"h-4 w-4"})])):o.key==="_liked_by"?(s(),r("div",de,[o.key=="_liked_by"?(s(),m(v,{key:0,variant:"ghosted",class:p(h(t)?"fill-red-500":"fill-white"),onClick:O(()=>u("likeDoc",{name:W.name,liked:h(t)}),["stop","prevent"])},{default:c(()=>[n(F,{class:"h-4 w-4"})]),_:1},8,["class","onClick"])):k("",!0)])):k("",!0)]),default:c(({label:b})=>[["modified","creation","first_response_time","first_responded_on","response_by"].includes(o.key)?(s(),r("div",{key:0,class:"truncate text-base",onClick:f=>u("applyFilter",{event:f,idx:e,column:o,item:t,firstColumn:a.columns[0]})},[n(d(S),{text:t.label},{default:c(()=>[j("div",null,B(t.timeAgo),1)]),_:2},1032,["text"])],8,ue)):o.key==="sla_status"?(s(),r("div",ce,[t.value?(s(),m(R,{key:0,variant:"subtle",theme:t.color,size:"md",label:t.value,onClick:f=>u("applyFilter",{event:f,idx:e,column:o,item:t,firstColumn:a.columns[0]})},null,8,["theme","label","onClick"])):k("",!0)])):o.type==="Check"?(s(),r("div",me,[n(I,{type:"checkbox",modelValue:t,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):(s(),r("div",{key:3,class:"truncate text-base",onClick:f=>u("applyFilter",{event:f,idx:e,column:o,item:t,firstColumn:a.columns[0]})},B(b),9,ke))]),_:2},1032,["item","align"]))]),_:1},8,["rows"]),n(d(ee),null,{actions:c(({selections:e,unselectAll:o})=>[n(d(se),{options:C.value.bulkActions(e,o)},{default:c(()=>[n(v,{icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"])]),_:1})]),_:1},8,["class","columns","rows","options"]),y.value?(s(),m(d(le),{key:0,class:"border-t sm:px-5 px-3 py-2",modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=e=>y.value=e),options:{rowCount:a.options.rowCount,totalCount:a.options.totalCount},onLoadMore:l[4]||(l[4]=e=>u("loadMore"))},null,8,["modelValue","options"])):k("",!0),n(E,{ref_key:"listBulkActionsRef",ref:C,modelValue:_.value,"onUpdate:modelValue":l[5]||(l[5]=e=>_.value=e),doctype:"CRM Deal"},null,8,["modelValue"])],64)}}};export{ge as _};
//# sourceMappingURL=DealsListView-983a0dcf.js.map
